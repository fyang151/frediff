<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Badiff Demo</title>
    <style>
      * {
        font-family: system-ui, sans-serif;
        box-sizing: border-box;
      }
      html {
        height: 100%;
      }
      body {
        max-width: 1200px;
        margin: 0 auto;
        padding: 1rem;
        font-size: 1.2rem;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .content {
        flex: 1;
      }
      h1,
      h2 {
        font-weight: 400;
        font-size: 2.2rem;
        margin-bottom: 3rem;
      }
      p {
        margin-bottom: 3rem;
      }
      .try-it {
        text-align: center;
        margin-bottom: 0.5rem;
      }
      .examples {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-bottom: 3rem;
      }
      .controls {
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 2rem;
      }
      button {
        background: none;
        color: inherit;
        border: none;
        padding: 0;
        cursor: pointer;
        font-family: inherit;
        font-size: inherit;
        font-style: italic;
        text-decoration: none;
      }
      button:hover {
        text-decoration: underline;
      }
      .checkbox-btn {
        cursor: pointer;
        user-select: none;
        font-style: italic;
      }
      .checkbox-btn:hover span {
        text-decoration: underline;
      }
      input[type="checkbox"] {
        display: none;
      }
      input[type="checkbox"]:checked + span {
        text-decoration: underline;
      }
      input[type="checkbox"]:checked + span:hover {
        text-decoration: none;
      }
      .column-header {
        display: flex;
        align-items: baseline;
        gap: 1rem;
        margin-bottom: 0.25rem;
      }
      .clear-btn {
        font-size: inherit;
      }
      .columns {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 1rem;
      }
      .column {
        min-width: 0;
      }
      .column label {
        display: block;
        margin-bottom: 0.25rem;
      }
      textarea,
      pre {
        width: 100%;
        min-height: 200px;
        height: auto;
        font-family: system-ui, sans-serif;
        font-size: inherit;
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-wrap: break-word;
        padding: 0;
        margin: 0;
        border: none;
        background: transparent;
        outline: none;
        resize: none;
        overflow: visible;
        transition: background 0.2s;
      }
      textarea:hover,
      textarea:focus {
        background: #f5f5f5;
      }
      .add {
        background: #cfc;
      }
      .del {
        background: #fcc;
      }
      a {
        color: inherit;
        text-decoration: underline;
      }
      a:hover {
        text-decoration: none;
      }
      sup {
        font-size: 0.75em;
      }
      .references {
        margin-top: auto;
        padding-top: 2rem;
        border-top: 2px solid #ddd;
        font-size: 0.85em;
      }
      .references p {
        margin: 0.5rem 0;
      }
      @media (max-width: 768px) {
        body {
          font-size: 1rem;
          padding: 0.5rem;
        }
        h1 {
          font-size: 1.8rem;
        }
        .controls {
          flex-wrap: wrap;
          gap: 1rem;
        }
        .examples {
          flex-direction: column;
          align-items: center;
          gap: 1rem;
        }
        .columns {
          grid-template-columns: 1fr;
          gap: 2rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="content">
      <h1>
        <a href="https://github.com/fyang151/badiff" target="_blank">Badiff</a>
        Demo
      </h1>

      <p>
        Is it possible to make diff algorithms on the web faster by compiling a
        C implementation to WebAssembly?
        <br />
        Who knows? Certainly not me. Badiff is a way for me to learn C - its a C
        implementation of the very smart Myers' diff algorithm<sup
          ><a href="#ref1">[1]</a></sup
        >
        compiled to WASM. I challenged myself to use no resources other than the
        original paper, including AI. In hindsight, I learned alot more about
        the algorithm than C, namely that it is much slower and produces much
        uglier diffs than bleeding edge diffing tools like
        <a href="https://www.diffchecker.com/" target="_blank"
          >diffchecker.com</a
        >. Seeing how Badiff will perform with some modern optimizations will be
        interesting, but as of right now I am happy. It may be a bad diffing
        algorithm, but it is a good learning experience.
      </p>

      <p class="try-it">Try it with...</p>

      <div class="examples">
        <button id="exampleFrankenstein">Frankenstein (1818 vs 1831)</button>
        <button id="exampleStranger">The Stranger (Ward vs Gilbert)</button>
      </div>

      <div class="controls">
        <button id="diffBtn">Run Diff</button>
        <label class="checkbox-btn">
          <input type="checkbox" id="realtime" checked />
          <span>Use realtime diff</span>
        </label>
        <span id="timer">0.000s</span>
      </div>

      <div class="columns">
        <div class="column">
          <div class="column-header">
            <label>Original</label>
            <button id="clearA" class="clear-btn">Clear</button>
          </div>
          <textarea id="textA">
This is my rifle. There are many like it, but this one is mine.</textarea
          >
        </div>
        <div class="column">
          <div class="column-header">
            <label>Modified</label>
            <button id="clearB" class="clear-btn">Clear</button>
          </div>
          <textarea id="textB">
This is my algorithm. There are many better ones, but this one is mine.</textarea
          >
        </div>
        <div class="column">
          <label>Diff</label>
          <pre id="output"></pre>
        </div>
      </div>
    </div>

    <div class="references">
      <p id="ref1">
        [1] Myers, E. W. (1986). An O(ND) Difference Algorithm and Its
        Variations. <em>Algorithmica</em>, 1(1), 251-266.
        <a
          href="https://neil.fraser.name/software/diff_match_patch/myers.pdf"
          target="_blank"
          >PDF</a
        >
      </p>
    </div>

    <script type="module" src="script.js"></script>
  </body>
</html>
